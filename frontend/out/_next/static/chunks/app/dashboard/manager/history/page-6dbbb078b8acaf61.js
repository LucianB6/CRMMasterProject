(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9378],{8773:(e,l,a)=>{"use strict";a.d(l,{k:()=>t});var s=a(43371);function t(e,l){var a;let t=(0,s.a)(e.start),r=(0,s.a)(e.end),n=+t>+r,o=n?+t:+r,i=n?r:t;i.setHours(0,0,0,0);let c=null!=(a=null==l?void 0:l.step)?a:1;if(!c)return[];c<0&&(c=-c,n=!n);let u=[];for(;+i<=o;)u.push((0,s.a)(i)),i.setDate(i.getDate()+c),i.setHours(0,0,0,0);return n?u.reverse():u}},11186:(e,l,a)=>{"use strict";a.d(l,{bq:()=>m,eb:()=>p,gC:()=>f,l6:()=>u,yv:()=>d});var s=a(95155),t=a(12115),r=a(20154),n=a(24033),o=a(12108),i=a(5917),c=a(64269);let u=r.bL;r.YJ;let d=r.WT,m=t.forwardRef((e,l)=>{let{className:a,children:t,...o}=e;return(0,s.jsxs)(r.l9,{ref:l,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...o,children:[t,(0,s.jsx)(r.In,{asChild:!0,children:(0,s.jsx)(n.A,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=r.l9.displayName;let x=t.forwardRef((e,l)=>{let{className:a,...t}=e;return(0,s.jsx)(r.PP,{ref:l,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",a),...t,children:(0,s.jsx)(o.A,{className:"h-4 w-4"})})});x.displayName=r.PP.displayName;let h=t.forwardRef((e,l)=>{let{className:a,...t}=e;return(0,s.jsx)(r.wn,{ref:l,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",a),...t,children:(0,s.jsx)(n.A,{className:"h-4 w-4"})})});h.displayName=r.wn.displayName;let f=t.forwardRef((e,l)=>{let{className:a,children:t,position:n="popper",...o}=e;return(0,s.jsx)(r.ZL,{children:(0,s.jsxs)(r.UC,{ref:l,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:n,...o,children:[(0,s.jsx)(x,{}),(0,s.jsx)(r.LM,{className:(0,c.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),(0,s.jsx)(h,{})]})})});f.displayName=r.UC.displayName,t.forwardRef((e,l)=>{let{className:a,...t}=e;return(0,s.jsx)(r.JU,{ref:l,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...t})}).displayName=r.JU.displayName;let p=t.forwardRef((e,l)=>{let{className:a,children:t,...n}=e;return(0,s.jsxs)(r.q7,{ref:l,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...n,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(r.VF,{children:(0,s.jsx)(i.A,{className:"h-4 w-4"})})}),(0,s.jsx)(r.p4,{children:t})]})});p.displayName=r.q7.displayName,t.forwardRef((e,l)=>{let{className:a,...t}=e;return(0,s.jsx)(r.wv,{ref:l,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",a),...t})}).displayName=r.wv.displayName},32078:(e,l,a)=>{"use strict";a.d(l,{f:()=>r});var s=a(43371),t=a(93673);function r(e,l){let a=(0,s.a)(e);return isNaN(l)?(0,t.w)(e,NaN):(l&&a.setDate(a.getDate()+l),a)}},48036:(e,l,a)=>{Promise.resolve().then(a.bind(a,67705))},67705:(e,l,a)=>{"use strict";a.r(l),a.d(l,{default:()=>Z});var s=a(95155),t=a(12115),r=a(26265),n=a(27105),o=a(68425),i=a(47734),c=a(73697),u=a(33420),d=a(73804),m=a(32078),x=a(90231),h=a(17206),f=a(43371),p=a(3617),j=a(8773),g=a(39089),b=a(77565),v=a(70990);function w(e,l,a){let s=(0,g.k)(e,a),t=(0,g.k)(l,a);return Math.round((s-(0,v.G)(s)-(t-(0,v.G)(t)))/b.my)}var y=a(48633),N=a(86948),k=a(87270),S=a(13406),A=a(11186),U=a(15894),B=a(90960),M=a(10512),D=a(69141),Y=a(89559),_=a(36100),C=a(1524),R=a(91761);let V={sales:{label:"Vanzari",dataKey:"sales",unitLabel:"Unitati",icon:M.A,showValue:!0,barName:"Vanzari"},calls:{label:"Apeluri Facute",dataKey:"calls",unitLabel:"Apeluri",icon:D.A,showValue:!1,barName:"Apeluri"},followUpSales:{label:"Vanzari Follow-up",dataKey:"followUpSales",unitLabel:"Unitati",icon:Y.A,showValue:!1,barName:"Vanzari Follow-up"},outboundBookings:{label:"Programari Outbound",dataKey:"outboundBookings",unitLabel:"Programari",icon:_.A,showValue:!1,barName:"Programari"}};function Z(){var e,l,a,b,v,Z,z,E;let{toast:L}=(0,U.dj)(),[P,T]=(0,t.useState)("all"),[O,W]=(0,t.useState)("last7Days"),[F,K]=(0,t.useState)([]),[G,H]=(0,t.useState)({last7Days:[],currentMonth:[],currentYear:[],previousYear:[]}),[X,q]=(0,t.useState)({last7Days:[],currentMonth:[],currentYear:[],previousYear:[]}),[I,J]=(0,t.useState)(!0),Q=(0,t.useCallback)(()=>window.localStorage.getItem("salesway_token"),[]),$=(0,t.useCallback)(e=>{let l=new Date;if("last7Days"===e)return{from:(0,m.f)(l,-6),to:l};return"currentMonth"===e?{from:(0,x.w)(l),to:l}:"currentYear"===e?{from:(0,h.D)(l),to:l}:{from:(0,h.D)((0,m.f)((0,h.D)(l),-365)),to:function(e){let l=(0,f.a)(e),a=l.getFullYear();return l.setFullYear(a+1,0,0),l.setHours(23,59,59,999),l}((0,m.f)((0,h.D)(l),-365))}},[]),ee=(0,t.useCallback)((e,l)=>({from:(0,p.GP)(e,"yyyy-MM-dd"),to:(0,p.GP)(l,"yyyy-MM-dd")}),[]),el=(0,t.useCallback)(e=>{var l,a,s,t,r,n,o;let i=e.inputs,c=(null!=(l=i.sales_one_call_close)?l:0)+(null!=(a=i.followup_sales)?a:0)+(null!=(s=i.upsells)?s:0);return{calls:null!=(t=i.outbound_dials)?t:0,outboundBookings:null!=(r=i.sales_call_booked_from_outbound)?r:0,followUpSales:null!=(n=i.followup_sales)?n:0,sales:c,value:null!=(o=i.contract_value)?o:0}},[]),ea=(0,t.useCallback)(e=>{let l=new Map;e.forEach(e=>{var a,s,t;let r=null!=(a=e.agent_membership_id)?a:"unknown",n=null!=(s=e.agent_email)?s:"Agent necunoscut",o=el(e),i=null!=(t=l.get(r))?t:{email:n,calls:0,sales:0,followUpSales:0,outboundBookings:0};l.set(r,{email:n,calls:i.calls+o.calls,sales:i.sales+o.sales,followUpSales:i.followUpSales+o.followUpSales,outboundBookings:i.outboundBookings+o.outboundBookings})});let a=Array.from(l.values()),s=e=>a.reduce((l,a)=>a[e]>l[e]?a:l,{email:"-",calls:0,sales:0,followUpSales:0,outboundBookings:0});return{sales:s("sales"),calls:s("calls"),followUpSales:s("followUpSales"),outboundBookings:s("outboundBookings")}},[el]),es=(0,t.useCallback)((e,l,a)=>{let s=(0,j.k)({start:l,end:a}),t=new Map;return e.forEach(e=>{t.set(e.report_date,e)}),s.map(e=>{var l,a,s,r,n;let o=(0,p.GP)(e,"yyyy-MM-dd"),i=t.get(o),c=i?el(i):null;return{period:(0,p.GP)(e,"EEE dd MMM",{locale:y.ro}),calls:null!=(l=null==c?void 0:c.calls)?l:0,outboundBookings:null!=(a=null==c?void 0:c.outboundBookings)?a:0,followUpSales:null!=(s=null==c?void 0:c.followUpSales)?s:0,sales:null!=(r=null==c?void 0:c.sales)?r:0,value:null!=(n=null==c?void 0:c.value)?n:0}})},[el]),et=(0,t.useCallback)((e,l,a)=>{let s=(0,g.k)(l,{weekStartsOn:1}),t=Array.from({length:w((0,g.k)(a,{weekStartsOn:1}),s,{weekStartsOn:1})+1},(e,l)=>({period:"Sapt. ".concat(l+1),calls:0,outboundBookings:0,followUpSales:0,sales:0,value:0}));return e.forEach(e=>{var l;let a=w(new Date(e.report_date),s,{weekStartsOn:1}),r=el(e),n=t[a];n&&(n.calls+=r.calls,n.outboundBookings+=r.outboundBookings,n.followUpSales+=r.followUpSales,n.sales+=r.sales,n.value+=null!=(l=r.value)?l:0)}),t},[el]),er=(0,t.useCallback)((e,l,a)=>{let s=Array.from({length:12},(e,a)=>{let s=new Date(Date.UTC(l.getUTCFullYear(),a,1));return{period:(0,p.GP)(s,"MMM",{locale:y.ro}),calls:0,outboundBookings:0,followUpSales:0,sales:0,value:0}});return e.forEach(e=>{var t;let r=new Date(e.report_date);if(r<l||r>a)return;let n=r.getUTCMonth(),o=el(e),i=s[n];i.calls+=o.calls,i.outboundBookings+=o.outboundBookings,i.followUpSales+=o.followUpSales,i.sales+=o.sales,i.value+=null!=(t=o.value)?t:0}),s},[el]),en=(0,t.useCallback)(async()=>{try{let e=Q(),l=await (0,B.nr)("/manager/overview/agents",{headers:e?{Authorization:"Bearer ".concat(e)}:void 0});K(l)}catch(e){L({title:"Eroare",description:e instanceof Error?e.message:"Eroare necunoscuta",variant:"destructive"})}},[Q,L]),eo=(0,t.useCallback)(async(e,l,a)=>{let s=Q(),t=new URLSearchParams(ee(e,l));return a&&t.set("agent_membership_id",a),await (0,B.nr)("/manager/reports?".concat(t.toString()),{headers:s?{Authorization:"Bearer ".concat(s)}:void 0})},[ee,Q]);(0,t.useEffect)(()=>{en()},[en]),(0,t.useEffect)(()=>{(async()=>{try{J(!0);let e="all"===P?null:P,l={last7Days:$("last7Days"),currentMonth:$("currentMonth"),currentYear:$("currentYear"),previousYear:$("previousYear")},[a,s,t,r]=await Promise.all([eo(l.last7Days.from,l.last7Days.to,e),eo(l.currentMonth.from,l.currentMonth.to,e),eo(l.currentYear.from,l.currentYear.to,e),eo(l.previousYear.from,l.previousYear.to,e)]);H({last7Days:es(a,l.last7Days.from,l.last7Days.to),currentMonth:et(s,l.currentMonth.from,l.currentMonth.to),currentYear:er(t,l.currentYear.from,l.currentYear.to),previousYear:er(r,l.previousYear.from,l.previousYear.to)}),q({last7Days:a,currentMonth:s,currentYear:t,previousYear:r})}catch(e){L({title:"Eroare",description:e instanceof Error?e.message:"Eroare necunoscuta",variant:"destructive"})}finally{J(!1)}})()},[es,er,et,$,eo,P,L]);let ei=(e,l,a)=>(0,s.jsxs)(S.tU,{defaultValue:"sales",className:"w-full",children:[(0,s.jsx)(S.j7,{className:"grid w-full grid-cols-2 sm:grid-cols-4",children:Object.keys(V).map(e=>(0,s.jsx)(S.Xi,{value:e,children:V[e].label},e))}),Object.keys(V).map(t=>(0,s.jsx)(S.av,{value:t,className:"mt-6",children:((e,l,a,t)=>{let m=V[a],x=((e,l)=>{let a=V[l].dataKey,s=e.reduce((e,l)=>e+(l[a]||0),0),t="sales"===l?e.reduce((e,l)=>e+(l.value||0),0):0,r=e.length>0?s/e.length:0;return{totalUnits:s,totalValue:t,averageUnits:r}})(l,a),h=m.icon;return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[(0,s.jsxs)(N.Zp,{children:[(0,s.jsxs)(N.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsxs)(N.ZB,{className:"text-sm font-medium",children:["Total (",m.unitLabel,")"]}),(0,s.jsx)(h,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsx)(N.Wu,{children:(0,s.jsx)("div",{className:"text-2xl font-bold",children:x.totalUnits})})]}),(0,s.jsxs)(N.Zp,{children:[(0,s.jsxs)(N.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(N.ZB,{className:"text-sm font-medium",children:"Medie / Perioada"}),(0,s.jsx)(C.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsx)(N.Wu,{children:(0,s.jsx)("div",{className:"text-2xl font-bold",children:x.averageUnits.toFixed(1)})})]}),m.showValue&&(0,s.jsxs)(N.Zp,{children:[(0,s.jsxs)(N.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(N.ZB,{className:"text-sm font-medium",children:"Valoare Totala (RON)"}),(0,s.jsx)(R.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsx)(N.Wu,{children:(0,s.jsx)("div",{className:"text-2xl font-bold",children:x.totalValue>0?x.totalValue.toLocaleString("ro-RO"):"-"})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[(0,s.jsxs)(N.Zp,{children:[(0,s.jsx)(N.aR,{children:(0,s.jsx)(N.ZB,{children:"Grafic ".concat(m.label," - ").concat(e)})}),(0,s.jsx)(N.Wu,{children:(0,s.jsx)(r.u,{width:"100%",height:300,children:(0,s.jsxs)(n.E,{data:l,children:[(0,s.jsx)(o.d,{strokeDasharray:"3 3",vertical:!1}),(0,s.jsx)(i.W,{dataKey:"period",stroke:"#888888",fontSize:12,tickLine:!1,axisLine:!1}),(0,s.jsx)(c.h,{stroke:"#888888",fontSize:12,tickLine:!1,axisLine:!1,allowDecimals:!1}),(0,s.jsx)(u.m,{contentStyle:{backgroundColor:"hsl(var(--card))",borderColor:"hsl(var(--border))"}}),(0,s.jsx)(d.yP,{dataKey:m.dataKey,name:m.barName,fill:"hsl(var(--primary))",radius:[4,4,0,0]})]})})})]}),(0,s.jsxs)(N.Zp,{children:[(0,s.jsx)(N.aR,{children:(0,s.jsx)(N.ZB,{children:"Tabel ".concat(m.label," - ").concat(e)})}),(0,s.jsx)(N.Wu,{children:(0,s.jsxs)(k.XI,{children:[(0,s.jsx)(k.A0,{children:(0,s.jsxs)(k.Hj,{children:[(0,s.jsx)(k.nd,{children:t}),(0,s.jsxs)(k.nd,{className:"text-right",children:[m.label," (",m.unitLabel,")"]}),m.showValue&&(0,s.jsx)(k.nd,{className:"text-right",children:"Valoare (RON)"})]})}),(0,s.jsx)(k.BF,{children:l.map(e=>(0,s.jsxs)(k.Hj,{children:[(0,s.jsx)(k.nA,{className:"font-medium",children:e.period}),(0,s.jsx)(k.nA,{className:"text-right",children:e[m.dataKey]}),m.showValue&&(0,s.jsx)(k.nA,{className:"text-right",children:(e.value||0).toLocaleString("ro-RO")})]},e.period))})]})})]})]})]})})(e,l,t,a)},t))]}),ec=(0,t.useMemo)(()=>"all"!==P?null:ea(X[O]),[ea,O,X,P]);return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("header",{children:[(0,s.jsx)("h1",{className:"font-headline text-2xl",children:"Istoric Echipa"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Analizeaza performanta istorica a echipei sau a unui agent specific."})]}),(0,s.jsxs)(N.Zp,{children:[(0,s.jsxs)(N.aR,{children:[(0,s.jsx)(N.ZB,{children:"Filtru Agent"}),(0,s.jsx)(N.BT,{children:'Selecteaza "Toti Agentii" pentru date agregate sau alege un agent.'})]}),(0,s.jsx)(N.Wu,{children:(0,s.jsxs)(A.l6,{value:P,onValueChange:T,children:[(0,s.jsx)(A.bq,{className:"w-full sm:w-[280px]",children:(0,s.jsx)(A.yv,{placeholder:"Selecteaza o optiune"})}),(0,s.jsxs)(A.gC,{children:[(0,s.jsx)(A.eb,{value:"all",children:"Toti Agentii"}),F.map(e=>(0,s.jsx)(A.eb,{value:e.membership_id,children:e.email},e.membership_id))]})]})})]}),I&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Se incarca istoricul..."}),"all"!==P?(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:'Selecteaza "Toti Agentii" pentru topuri pe echipa.'}):(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold tracking-tight",children:"Top performanta echipa"}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,s.jsxs)(N.Zp,{children:[(0,s.jsxs)(N.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(N.ZB,{className:"text-sm font-medium",children:"Top Vanzari"}),(0,s.jsx)(M.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsxs)(N.Wu,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:null!=(e=null==ec?void 0:ec.sales.sales)?e:0}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:null!=(l=null==ec?void 0:ec.sales.email)?l:"-"})]})]}),(0,s.jsxs)(N.Zp,{children:[(0,s.jsxs)(N.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(N.ZB,{className:"text-sm font-medium",children:"Top Apeluri"}),(0,s.jsx)(D.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsxs)(N.Wu,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:null!=(a=null==ec?void 0:ec.calls.calls)?a:0}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:null!=(b=null==ec?void 0:ec.calls.email)?b:"-"})]})]}),(0,s.jsxs)(N.Zp,{children:[(0,s.jsxs)(N.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(N.ZB,{className:"text-sm font-medium",children:"Top Vanzari Follow-up"}),(0,s.jsx)(Y.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsxs)(N.Wu,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:null!=(v=null==ec?void 0:ec.followUpSales.followUpSales)?v:0}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:null!=(Z=null==ec?void 0:ec.followUpSales.email)?Z:"-"})]})]}),(0,s.jsxs)(N.Zp,{children:[(0,s.jsxs)(N.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(N.ZB,{className:"text-sm font-medium",children:"Top Programari Outbound"}),(0,s.jsx)(_.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsxs)(N.Wu,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:null!=(z=null==ec?void 0:ec.outboundBookings.outboundBookings)?z:0}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:null!=(E=null==ec?void 0:ec.outboundBookings.email)?E:"-"})]})]})]})]}),(0,s.jsxs)(S.tU,{defaultValue:"last7Days",className:"w-full",value:O,onValueChange:e=>W(e),children:[(0,s.jsxs)(S.j7,{className:"grid w-full grid-cols-2 sm:grid-cols-4",children:[(0,s.jsx)(S.Xi,{value:"last7Days",children:"Ultimele 7 zile"}),(0,s.jsx)(S.Xi,{value:"currentMonth",children:"Luna curenta"}),(0,s.jsx)(S.Xi,{value:"currentYear",children:"Anul curent"}),(0,s.jsx)(S.Xi,{value:"previousYear",children:"Anul precedent"})]}),(0,s.jsx)(S.av,{value:"last7Days",className:"mt-6",children:ei("Ultimele 7 zile",G.last7Days,"Ziua")}),(0,s.jsx)(S.av,{value:"currentMonth",className:"mt-6",children:ei("Luna Curenta",G.currentMonth,"Saptamana")}),(0,s.jsx)(S.av,{value:"currentYear",className:"mt-6",children:ei("Anul Curent",G.currentYear,"Luna")}),(0,s.jsx)(S.av,{value:"previousYear",className:"mt-6",children:ei("Anul Precedent",G.previousYear,"Luna")})]})]})}},90231:(e,l,a)=>{"use strict";a.d(l,{w:()=>t});var s=a(43371);function t(e){let l=(0,s.a)(e);return l.setDate(1),l.setHours(0,0,0,0),l}}},e=>{e.O(0,[4909,2034,6625,3780,7443,1171,4964,2201,1276,8441,1255,7358],()=>e(e.s=48036)),_N_E=e.O()}]);