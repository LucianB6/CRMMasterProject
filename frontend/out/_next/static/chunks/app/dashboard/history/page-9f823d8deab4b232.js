(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8610],{17129:(e,l,a)=>{"use strict";a.d(l,{DX:()=>s,xV:()=>o});var t=a(12115),r=a(95155),s=t.forwardRef((e,l)=>{let{children:a,...s}=e,o=t.Children.toArray(a),u=o.find(i);if(u){let e=u.props.children,a=o.map(l=>l!==u?l:t.Children.count(e)>1?t.Children.only(null):t.isValidElement(e)?e.props.children:null);return(0,r.jsx)(n,{...s,ref:l,children:t.isValidElement(e)?t.cloneElement(e,void 0,a):null})}return(0,r.jsx)(n,{...s,ref:l,children:a})});s.displayName="Slot";var n=t.forwardRef((e,l)=>{let{children:a,...r}=e;if(t.isValidElement(a)){let e=function(e){let l=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,a=l&&"isReactWarning"in l&&l.isReactWarning;return a?e.ref:(a=(l=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in l&&l.isReactWarning)?e.props.ref:e.props.ref||e.ref}(a);return t.cloneElement(a,{...function(e,l){let a={...l};for(let t in l){let r=e[t],s=l[t];/^on[A-Z]/.test(t)?r&&s?a[t]=(...e)=>{s(...e),r(...e)}:r&&(a[t]=r):"style"===t?a[t]={...r,...s}:"className"===t&&(a[t]=[r,s].filter(Boolean).join(" "))}return{...e,...a}}(r,a.props),ref:l?function(...e){return l=>e.forEach(e=>{"function"==typeof e?e(l):null!=e&&(e.current=l)})}(l,e):e})}return t.Children.count(a)>1?t.Children.only(null):null});n.displayName="SlotClone";var o=({children:e})=>(0,r.jsx)(r.Fragment,{children:e});function i(e){return t.isValidElement(e)&&e.type===o}},42903:(e,l,a)=>{"use strict";a.r(l),a.d(l,{default:()=>V});var t=a(95155),r=a(12115),s=a(26265),n=a(27105),o=a(68425),i=a(47734),u=a(73697),c=a(33420),d=a(73804),h=a(86948),m=a(87270),p=a(13406),f=a(15894),x=a(90960),g=a(10512),v=a(69141),j=a(89559),w=a(36100),b=a(1524),U=a(91761);let y={sales:{label:"V\xe2nzări",dataKey:"sales",unitLabel:"Unități",icon:g.A,showValue:!0,barName:"V\xe2nzări"},calls:{label:"Apeluri Făcute",dataKey:"calls",unitLabel:"Apeluri",icon:v.A,showValue:!1,barName:"Apeluri"},followUpSales:{label:"V\xe2nzări Follow-up",dataKey:"followUpSales",unitLabel:"Unități",icon:j.A,showValue:!1,barName:"V\xe2nzări Follow-up"},outboundBookings:{label:"Programări Outbound",dataKey:"outboundBookings",unitLabel:"Programări",icon:w.A,showValue:!1,barName:"Programări"}},N=new Set(["SUBMITTED","AUTO_SUBMITTED"]),C={last7Days:[],currentMonth:[],currentYear:[],previousYear:[]},k=e=>new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate())),T=(e,l)=>new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()+l)),S=e=>e.toISOString().split("T")[0],D=e=>new Date("".concat(e,"T00:00:00Z")),A=e=>{var l,a,t,r,s,n,o;let i=e.inputs;return{sales:(null!=(l=i.sales_one_call_close)?l:0)+(null!=(a=i.followup_sales)?a:0)+(null!=(t=i.upsells)?t:0),calls:null!=(r=i.outbound_dials)?r:0,followUpSales:null!=(s=i.followup_sales)?s:0,outboundBookings:null!=(n=i.sales_call_booked_from_outbound)?n:0,value:null!=(o=i.contract_value)?o:0}},B=(e,l)=>{let a=new Map;return e.forEach(e=>{var t;if(!N.has(e.status))return;let r=D(e.reportDate);if(r.getUTCFullYear()!==l)return;let s=r.getUTCMonth(),n=null!=(t=a.get(s))?t:{sales:0,calls:0,followUpSales:0,outboundBookings:0,value:0},o=A(e);a.set(s,{sales:n.sales+o.sales,calls:n.calls+o.calls,followUpSales:n.followUpSales+o.followUpSales,outboundBookings:n.outboundBookings+o.outboundBookings,value:n.value+o.value})}),Array.from({length:12},(e,t)=>{var r,s,n,o,i;let u=(e=>{let l=e.toLocaleString("ro-RO",{month:"short"}).replace(".","");return l.charAt(0).toUpperCase()+l.slice(1)})(new Date(Date.UTC(l,t,1))),c=a.get(t);return{period:u,sales:null!=(r=null==c?void 0:c.sales)?r:0,calls:null!=(s=null==c?void 0:c.calls)?s:0,followUpSales:null!=(n=null==c?void 0:c.followUpSales)?n:0,outboundBookings:null!=(o=null==c?void 0:c.outboundBookings)?o:0,value:null!=(i=null==c?void 0:c.value)?i:0}})};function V(){let{toast:e}=(0,f.dj)(),[l,a]=(0,r.useState)(C),[g,v]=(0,r.useState)(!0),j=(0,r.useCallback)(()=>window.localStorage.getItem("salesway_token"),[]),w=(0,r.useCallback)(async()=>{v(!0);try{let e=j(),l=e?{Authorization:"Bearer ".concat(e)}:void 0,t=k(new Date),r=new Date(Date.UTC(t.getUTCFullYear(),0,1)),s=new Date(Date.UTC(t.getUTCFullYear()-1,0,1)),n=new Date(Date.UTC(t.getUTCFullYear()-1,11,31)),[o,i,u,c]=await Promise.all([(0,x.nr)("/reports/daily/recent?days=7",{headers:l}),(0,x.nr)("/reports/daily/current-month",{headers:l}),(0,x.nr)("/reports/daily?from=".concat(S(r),"&to=").concat(S(t)),{headers:l}),(0,x.nr)("/reports/daily?from=".concat(S(s),"&to=").concat(S(n)),{headers:l})]),d=T(t,-6),h=new Date(Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),1)),m=new Date(Date.UTC(t.getUTCFullYear(),t.getUTCMonth()+1,0));a({last7Days:((e,l,a,t)=>{let r=new Map;e.forEach(e=>{N.has(e.status)&&r.set(e.reportDate,A(e))});let s=[],n=k(l),o=k(a),i=k(t);for(;n<=o;){var u,c,d,h,m;let e=S(n),l=Math.round((i.getTime()-n.getTime())/864e5),a="".concat(l," zile");a=0===l?"Azi":1===l?"Ieri":"Acum ".concat(l," zile");let t=r.get(e);s.push({period:a,sales:null!=(u=null==t?void 0:t.sales)?u:0,calls:null!=(c=null==t?void 0:t.calls)?c:0,followUpSales:null!=(d=null==t?void 0:t.followUpSales)?d:0,outboundBookings:null!=(h=null==t?void 0:t.outboundBookings)?h:0,value:null!=(m=null==t?void 0:t.value)?m:0}),n=T(n,1)}return s})(o,d,t,t),currentMonth:((e,l,a)=>{let t=new Map;return e.forEach(e=>{var r;if(!N.has(e.status))return;let s=D(e.reportDate);if(s<l||s>a)return;let n=Math.floor((s.getUTCDate()-1)/7)+1,o=null!=(r=t.get(n))?r:{sales:0,calls:0,followUpSales:0,outboundBookings:0,value:0},i=A(e);t.set(n,{sales:o.sales+i.sales,calls:o.calls+i.calls,followUpSales:o.followUpSales+i.followUpSales,outboundBookings:o.outboundBookings+i.outboundBookings,value:o.value+i.value})}),Array.from({length:Math.ceil(a.getUTCDate()/7)},(e,l)=>{var a,r,s,n,o;let i=l+1,u=t.get(i);return{period:"Săpt. ".concat(i),sales:null!=(a=null==u?void 0:u.sales)?a:0,calls:null!=(r=null==u?void 0:u.calls)?r:0,followUpSales:null!=(s=null==u?void 0:u.followUpSales)?s:0,outboundBookings:null!=(n=null==u?void 0:u.outboundBookings)?n:0,value:null!=(o=null==u?void 0:u.value)?o:0}})})(i,h,m),currentYear:B(u,t.getUTCFullYear()),previousYear:B(c,t.getUTCFullYear()-1)})}catch(l){e({title:"Nu am putut \xeencărca istoricul",description:l instanceof Error?l.message:"Eroare necunoscută",variant:"destructive"})}finally{v(!1)}},[j,e]);(0,r.useEffect)(()=>{w()},[w]);let V=(e,l,a)=>(0,t.jsxs)(p.tU,{defaultValue:"sales",className:"w-full",children:[(0,t.jsx)(p.j7,{className:"grid w-full grid-cols-2 sm:grid-cols-4",children:Object.keys(y).map(e=>(0,t.jsx)(p.Xi,{value:e,children:y[e].label},e))}),Object.keys(y).map(r=>(0,t.jsx)(p.av,{value:r,className:"mt-6",children:((e,l,a,r)=>{let p=y[a],f=((e,l)=>{let a=y[l].dataKey,t=e.reduce((e,l)=>e+(l[a]||0),0),r="sales"===l?e.reduce((e,l)=>e+(l.value||0),0):0,s=e.length>0?t/e.length:0;return{totalUnits:t,totalValue:r,averageUnits:s}})(l,a),x=p.icon;return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[(0,t.jsxs)(h.Zp,{children:[(0,t.jsxs)(h.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsxs)(h.ZB,{className:"text-sm font-medium",children:["Total (",p.unitLabel,")"]}),(0,t.jsx)(x,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsx)(h.Wu,{children:(0,t.jsx)("div",{className:"text-2xl font-bold",children:f.totalUnits})})]}),(0,t.jsxs)(h.Zp,{children:[(0,t.jsxs)(h.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(h.ZB,{className:"text-sm font-medium",children:"Medie / Perioadă"}),(0,t.jsx)(b.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsx)(h.Wu,{children:(0,t.jsx)("div",{className:"text-2xl font-bold",children:f.averageUnits.toFixed(1)})})]}),p.showValue&&(0,t.jsxs)(h.Zp,{children:[(0,t.jsxs)(h.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(h.ZB,{className:"text-sm font-medium",children:"Valoare Totală (RON)"}),(0,t.jsx)(U.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsx)(h.Wu,{children:(0,t.jsx)("div",{className:"text-2xl font-bold",children:f.totalValue>0?f.totalValue.toLocaleString("ro-RO"):"-"})})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[(0,t.jsxs)(h.Zp,{children:[(0,t.jsx)(h.aR,{children:(0,t.jsx)(h.ZB,{children:"Grafic ".concat(p.label," - ").concat(e)})}),(0,t.jsx)(h.Wu,{children:(0,t.jsx)(s.u,{width:"100%",height:300,children:(0,t.jsxs)(n.E,{data:l,children:[(0,t.jsx)(o.d,{strokeDasharray:"3 3",vertical:!1}),(0,t.jsx)(i.W,{dataKey:"period",stroke:"#888888",fontSize:12,tickLine:!1,axisLine:!1}),(0,t.jsx)(u.h,{stroke:"#888888",fontSize:12,tickLine:!1,axisLine:!1,allowDecimals:!1}),(0,t.jsx)(c.m,{contentStyle:{backgroundColor:"hsl(var(--card))",borderColor:"hsl(var(--border))"}}),(0,t.jsx)(d.yP,{dataKey:p.dataKey,name:p.barName,fill:"hsl(var(--primary))",radius:[4,4,0,0]})]})})})]}),(0,t.jsxs)(h.Zp,{children:[(0,t.jsx)(h.aR,{children:(0,t.jsx)(h.ZB,{children:"Tabel ".concat(p.label," - ").concat(e)})}),(0,t.jsx)(h.Wu,{children:(0,t.jsxs)(m.XI,{children:[(0,t.jsx)(m.A0,{children:(0,t.jsxs)(m.Hj,{children:[(0,t.jsx)(m.nd,{children:r}),(0,t.jsxs)(m.nd,{className:"text-right",children:[p.label," (",p.unitLabel,")"]}),p.showValue&&(0,t.jsx)(m.nd,{className:"text-right",children:"Valoare (RON)"})]})}),(0,t.jsx)(m.BF,{children:l.map(e=>(0,t.jsxs)(m.Hj,{children:[(0,t.jsx)(m.nA,{className:"font-medium",children:e.period}),(0,t.jsx)(m.nA,{className:"text-right",children:e[p.dataKey]}),p.showValue&&(0,t.jsx)(m.nA,{className:"text-right",children:(e.value||0).toLocaleString("ro-RO")})]},e.period))})]})})]})]})]})})(e,l,r,a)},r))]});return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("header",{children:[(0,t.jsx)("h1",{className:"font-headline text-2xl",children:"Istoric V\xe2nzări & Activitate"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Analizează performanța ta pe diferite perioade de timp."})]}),g?(0,t.jsx)("div",{className:"rounded-lg border border-dashed p-6 text-sm text-muted-foreground",children:"Se \xeencarcă istoricul..."}):(0,t.jsxs)(p.tU,{defaultValue:"7days",className:"w-full",children:[(0,t.jsxs)(p.j7,{className:"grid w-full grid-cols-2 sm:grid-cols-4",children:[(0,t.jsx)(p.Xi,{value:"7days",children:"Ultimele 7 zile"}),(0,t.jsx)(p.Xi,{value:"currentMonth",children:"Luna curentă"}),(0,t.jsx)(p.Xi,{value:"currentYear",children:"Anul curent"}),(0,t.jsx)(p.Xi,{value:"previousYear",children:"Anul precedent"})]}),(0,t.jsx)(p.av,{value:"7days",className:"mt-6",children:V("Ultimele 7 zile",l.last7Days,"Ziua")}),(0,t.jsx)(p.av,{value:"currentMonth",className:"mt-6",children:V("Luna Curentă",l.currentMonth,"Săptăm\xe2na")}),(0,t.jsx)(p.av,{value:"currentYear",className:"mt-6",children:V("Anul Curent",l.currentYear,"Luna")}),(0,t.jsx)(p.av,{value:"previousYear",className:"mt-6",children:V("Anul Precedent",l.previousYear,"Luna")})]})]})}},71847:(e,l,a)=>{"use strict";a.d(l,{A:()=>o});var t=a(12115);let r=function(){for(var e=arguments.length,l=Array(e),a=0;a<e;a++)l[a]=arguments[a];return l.filter((e,l,a)=>!!e&&a.indexOf(e)===l).join(" ")};var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,t.forwardRef)((e,l)=>{let{color:a="currentColor",size:n=24,strokeWidth:o=2,absoluteStrokeWidth:i,className:u="",children:c,iconNode:d,...h}=e;return(0,t.createElement)("svg",{ref:l,...s,width:n,height:n,stroke:a,strokeWidth:i?24*Number(o)/Number(n):o,className:r("lucide",u),...h},[...d.map(e=>{let[l,a]=e;return(0,t.createElement)(l,a)}),...Array.isArray(c)?c:[c]])}),o=(e,l)=>{let a=(0,t.forwardRef)((a,s)=>{let{className:o,...i}=a;return(0,t.createElement)(n,{ref:s,iconNode:l,className:r("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),o),...i})});return a.displayName="".concat(e),a}},72926:(e,l,a)=>{Promise.resolve().then(a.bind(a,42903))}},e=>{e.O(0,[4909,7963,4964,1276,8441,1255,7358],()=>e(e.s=72926)),_N_E=e.O()}]);