(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5105],{3998:(e,t,s)=>{"use strict";s.d(t,{$:()=>c});var a=s(95155),r=s(12115),l=s(17129),i=s(92885),n=s(64269);let o=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:s,variant:r,size:i,asChild:c=!1,...d}=e,u=c?l.DX:"button";return(0,a.jsx)(u,{className:(0,n.cn)(o({variant:r,size:i,className:s})),ref:t,...d})});c.displayName="Button"},13406:(e,t,s)=>{"use strict";s.d(t,{Xi:()=>c,av:()=>d,j7:()=>o,tU:()=>n});var a=s(95155),r=s(12115),l=s(84964),i=s(64269);let n=l.bL,o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.B8,{ref:t,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...r})});o.displayName=l.B8.displayName;let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.l9,{ref:t,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...r})});c.displayName=l.l9.displayName;let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.UC,{ref:t,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...r})});d.displayName=l.UC.displayName},15894:(e,t,s)=>{"use strict";s.d(t,{dj:()=>u});var a=s(12115);let r=0,l=new Map,i=e=>{if(l.has(e))return;let t=setTimeout(()=>{l.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);l.set(e,t)},n=[],o={toasts:[]};function c(e){o=((e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?i(s):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}})(o,e),n.forEach(e=>{e(o)})}function d(e){let{...t}=e,s=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>c({type:"DISMISS_TOAST",toastId:s});return c({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||a()}}}),{id:s,dismiss:a,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function u(){let[e,t]=a.useState(o);return a.useEffect(()=>(n.push(t),()=>{let e=n.indexOf(t);e>-1&&n.splice(e,1)}),[e]),{...e,toast:d,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},20243:(e,t,s)=>{"use strict";s.d(t,{E:()=>l});var a=s(95155);s(12115);var r=s(64269);function l(e){let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,r.cn)("animate-pulse rounded-md bg-muted",t),...s})}},60116:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>M});var a=s(95155),r=s(26265),l=s(27105),i=s(68425),n=s(47734),o=s(73697),c=s(33420),d=s(37665),u=s(73804),p=s(78874),m=s(18514),f=s(61362),h=s(99708),x=s(69141),v=s(30814),g=s(1524),j=s(91761),_=s(26983),b=s(85998),y=s(12115),w=s(20063),N=s(86948),S=s(13406),k=s(3998),T=s(86259),D=s(20243),E=s(15894),A=s(90960),C=s(64269);let R={id:"",reportDate:"",status:"DRAFT",submittedAt:null,inputs:{outbound_dials:0,pickups:0,conversations_30s_plus:0,sales_call_booked_from_outbound:0,sales_call_on_calendar:0,no_show:0,reschedule_request:0,cancel:0,deposits:0,sales_one_call_close:0,followup_sales:0,upsell_conversation_taken:0,upsells:0,contract_value:0,new_cash_collected:0}},z={unfilled:{text:"Necompletat",icon:p.A,color:"text-destructive",buttonText:"Completează raportul"},draft:{text:"Draft",icon:m.A,color:"text-yellow-500",buttonText:"Continuă raportul"},submitted:{text:"Trimis",icon:f.A,color:"text-green-500",buttonText:"Vezi raportul trimis"},locked:{text:"Blocat",icon:h.A,color:"text-muted-foreground",buttonText:"Vezi raportul"}},I=e=>e.toISOString().slice(0,10),U=(e,t)=>{let s=new Date(e);return s.setUTCDate(s.getUTCDate()+t),s},O=[{id:1,text:"Managerul a aprobat raportul de Vineri.",time:"Acum 15 minute"},{id:2,text:"Ai primit permisiunea de a edita raportul de Joi.",time:"Acum 2 ore"},{id:3,text:"Raportul de Miercuri a fost marcat ca \xeent\xe2rziat.",time:"Ieri"}];function M(){let e=(0,w.useRouter)(),{toast:t}=(0,E.dj)(),[s,p]=(0,y.useState)(!1),[m,f]=(0,y.useState)(!0),[h,M]=(0,y.useState)(!0),[B,P]=(0,y.useState)("draft"),[F,V]=(0,y.useState)(R),[W,Z]=(0,y.useState)([]),[L,K]=(0,y.useState)([]),[X]=(0,y.useState)(new Date(new Date().setHours(19,0,0,0))),[$,q]=(0,y.useState)(""),H=(0,y.useCallback)(()=>window.localStorage.getItem("salesway_token"),[]),J=(0,y.useCallback)((e,t)=>t?"SUBMITTED"===e||"AUTO_SUBMITTED"===e?"submitted":"draft":"unfilled",[]),Q=(0,y.useCallback)(e=>{let t=e=>null!=e?e:0;return{...e,inputs:{outbound_dials:t(e.inputs.outbound_dials),pickups:t(e.inputs.pickups),conversations_30s_plus:t(e.inputs.conversations_30s_plus),sales_call_booked_from_outbound:t(e.inputs.sales_call_booked_from_outbound),sales_call_on_calendar:t(e.inputs.sales_call_on_calendar),no_show:t(e.inputs.no_show),reschedule_request:t(e.inputs.reschedule_request),cancel:t(e.inputs.cancel),deposits:t(e.inputs.deposits),sales_one_call_close:t(e.inputs.sales_one_call_close),followup_sales:t(e.inputs.followup_sales),upsell_conversation_taken:t(e.inputs.upsell_conversation_taken),upsells:t(e.inputs.upsells),contract_value:t(e.inputs.contract_value),new_cash_collected:t(e.inputs.new_cash_collected)}}},[]),Y=(0,y.useCallback)(e=>new Intl.NumberFormat("ro-RO").format(e),[]),G=(0,y.useCallback)(e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(e),[]);(0,y.useEffect)(()=>{if("manager"===window.localStorage.getItem("userRole"))return void e.replace("/dashboard/manager/overview");p(!0)},[e]);let ee=(0,y.useCallback)((e,t,s,a)=>{let r=new Map;e.forEach(e=>{let t=Q(e);r.set(t.reportDate,t)});let l=[];for(let e=new Date(t);e<=s;e=U(e,1)){var i,n;let t=I(e),s=null!=(n=null==(i=r.get(t))?void 0:i.inputs)?n:R.inputs;l.push({day:a(e),calls:s.outbound_dials,sales:s.sales_one_call_close+s.followup_sales})}return l},[Q]);(0,y.useEffect)(()=>{let e=setInterval(()=>{let t=new Date,s=X.getTime()-t.getTime();if(s<=0){q("Deadline atins"),P("locked"),clearInterval(e);return}let a=Math.floor(s/36e5),r=Math.floor(s%36e5/6e4),l=Math.floor(s%6e4/1e3);q("".concat(a.toString().padStart(2,"0"),"h ").concat(r.toString().padStart(2,"0"),"m ").concat(l.toString().padStart(2,"0"),"s"))},1e3);return()=>clearInterval(e)},[X]),(0,y.useEffect)(()=>{(async()=>{try{let e=H(),t=await (0,A.nr)("/reports/daily/today",{headers:e?{Authorization:"Bearer ".concat(e)}:void 0}),s=Q(t);V(s),P(J(t.status,t.id))}catch(e){t({title:"Nu am putut \xeencărca datele dashboard-ului",description:e instanceof Error?e.message:"Eroare necunoscută",variant:"destructive"})}finally{f(!1)}})()},[H,Q,J,t]),(0,y.useEffect)(()=>{(async()=>{try{let e,t=H(),s=t?{Authorization:"Bearer ".concat(t)}:void 0,[a,r]=await Promise.all([(0,A.nr)("/reports/daily/recent?days=7",{headers:s}),(0,A.nr)("/reports/daily/current-month",{headers:s})]),l=(e=new Date,new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()))),i=U(l,-6),n=new Date(Date.UTC(l.getUTCFullYear(),l.getUTCMonth(),1));Z(ee(a,i,l,e=>e.toLocaleDateString("ro-RO",{weekday:"short"}))),K(ee(r,n,l,e=>e.toLocaleDateString("ro-RO",{day:"numeric"})))}catch(e){t({title:"Nu am putut \xeencărca graficele",description:e instanceof Error?e.message:"Eroare necunoscută",variant:"destructive"})}finally{M(!1)}})()},[ee,H,t]);let et=z[B],es=et.icon,ea=(0,y.useMemo)(()=>[{title:"Apeluri făcute",value:Y(F.inputs.outbound_dials),icon:x.A},{title:"Conversii",value:Y(F.inputs.pickups),icon:v.A},{title:"V\xe2nzări \xeenchise",value:Y(F.inputs.sales_one_call_close+F.inputs.followup_sales),icon:g.A},{title:"Valoare v\xe2nzări",value:G(F.inputs.contract_value),icon:j.A}],[G,Y,F.inputs.contract_value,F.inputs.followup_sales,F.inputs.outbound_dials,F.inputs.pickups,F.inputs.sales_one_call_close]);return!s||m||h?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(D.E,{className:"h-24 w-full"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(D.E,{className:"h-8 w-48"}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,a.jsx)(D.E,{className:"h-28 w-full"}),(0,a.jsx)(D.E,{className:"h-28 w-full"}),(0,a.jsx)(D.E,{className:"h-28 w-full"}),(0,a.jsx)(D.E,{className:"h-28 w-full"})]})]}),(0,a.jsx)(D.E,{className:"h-96 w-full"})]}):(0,a.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,a.jsx)(N.Zp,{children:(0,a.jsx)(N.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 items-center gap-4 sm:grid-cols-[1fr_auto_auto] sm:gap-6",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"font-headline text-xl",children:new Date().toLocaleDateString("ro-RO",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(es,{className:(0,C.cn)("h-5 w-5",et.color)}),(0,a.jsxs)("span",{className:(0,C.cn)("font-semibold",et.color),children:["Status raport: ",et.text]})]})]}),(0,a.jsxs)("div",{className:"text-left sm:text-right",children:[(0,a.jsxs)("div",{className:"flex items-center justify-start gap-2 text-muted-foreground sm:justify-end",children:[(0,a.jsx)(_.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm font-semibold",children:$})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"p\xe2nă la publicare automată"})]}),(0,a.jsx)(k.$,{size:"lg",disabled:"locked"===B,className:"w-full shrink-0 sm:w-auto",onClick:()=>e.push("/dashboard/report"),children:et.buttonText})]})})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold tracking-tight",children:"Quick Stats - Azi"}),(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:ea.map(e=>(0,a.jsxs)(N.Zp,{children:[(0,a.jsxs)(N.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(N.ZB,{className:"text-sm font-medium",children:e.title}),(0,a.jsx)(e.icon,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(N.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:e.value}),"draft"===B&&(0,a.jsx)("p",{className:"text-xs text-yellow-500",children:"date nefinalizate"})]})]},e.title))})]}),(0,a.jsx)(N.Zp,{children:(0,a.jsxs)(N.Wu,{className:"flex flex-col items-start gap-4 p-6 sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold",children:"Raportul zilei"}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Stare:"," ","draft"===B?"Draft salvat, netrimis.":"Niciun draft activ."]})]}),(0,a.jsx)(k.$,{variant:"outline",onClick:()=>e.push("/dashboard/report"),className:"w-full shrink-0 sm:w-auto",children:"Editează raportul de azi"})]})}),(0,a.jsxs)(N.Zp,{children:[(0,a.jsx)(N.aR,{children:(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(N.ZB,{children:"Istoric personal"}),(0,a.jsx)(N.BT,{children:"Sumarul activității tale."})]}),(0,a.jsx)(k.$,{variant:"link",className:"pr-0",children:"Vezi istoricul complet"})]})}),(0,a.jsx)(N.Wu,{children:(0,a.jsxs)(S.tU,{defaultValue:"7",children:[(0,a.jsxs)(S.j7,{className:"mb-4",children:[(0,a.jsx)(S.Xi,{value:"7",children:"Ultimele 7 zile"}),(0,a.jsx)(S.Xi,{value:"month",children:"Luna curentă"})]}),(0,a.jsx)(S.av,{value:"7",children:(0,a.jsx)(r.u,{width:"100%",height:200,children:(0,a.jsxs)(l.E,{data:W,children:[(0,a.jsx)(i.d,{strokeDasharray:"3 3",vertical:!1}),(0,a.jsx)(n.W,{dataKey:"day",stroke:"#888888",fontSize:12}),(0,a.jsx)(o.h,{stroke:"#888888",fontSize:12,allowDecimals:!1}),(0,a.jsx)(c.m,{contentStyle:{backgroundColor:"hsl(var(--card))",borderColor:"hsl(var(--border))"}}),(0,a.jsx)(d.s,{iconSize:10}),(0,a.jsx)(u.yP,{dataKey:"calls",name:"Apeluri",fill:"hsl(var(--chart-1))",radius:[4,4,0,0]}),(0,a.jsx)(u.yP,{dataKey:"sales",name:"V\xe2nzări",fill:"hsl(var(--chart-2))",radius:[4,4,0,0]})]})})}),(0,a.jsx)(S.av,{value:"month",children:(0,a.jsx)(r.u,{width:"100%",height:200,children:(0,a.jsxs)(l.E,{data:L,children:[(0,a.jsx)(i.d,{strokeDasharray:"3 3",vertical:!1}),(0,a.jsx)(n.W,{dataKey:"day",stroke:"#888888",fontSize:12}),(0,a.jsx)(o.h,{stroke:"#888888",fontSize:12,allowDecimals:!1}),(0,a.jsx)(c.m,{contentStyle:{backgroundColor:"hsl(var(--card))",borderColor:"hsl(var(--border))"}}),(0,a.jsx)(d.s,{iconSize:10}),(0,a.jsx)(u.yP,{dataKey:"calls",name:"Apeluri",fill:"hsl(var(--chart-1))",radius:[4,4,0,0]}),(0,a.jsx)(u.yP,{dataKey:"sales",name:"V\xe2nzări",fill:"hsl(var(--chart-2))",radius:[4,4,0,0]})]})})})]})})]}),(0,a.jsxs)(N.Zp,{children:[(0,a.jsx)(N.aR,{children:(0,a.jsx)(N.ZB,{children:"Notificări personale"})}),(0,a.jsx)(N.Wu,{children:(0,a.jsx)("div",{className:"flex flex-col gap-4",children:O.map((e,t)=>(0,a.jsxs)(y.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-muted",children:(0,a.jsx)(b.A,{className:"h-4 w-4 text-muted-foreground"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm",children:e.text}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.time})]})]}),t<O.length-1&&(0,a.jsx)(T.w,{})]},e.id))})})]})]})}},64269:(e,t,s)=>{"use strict";s.d(t,{cn:()=>l});var a=s(2821),r=s(75889);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.QP)((0,a.$)(t))}},82413:(e,t,s)=>{Promise.resolve().then(s.bind(s,60116))},86259:(e,t,s)=>{"use strict";s.d(t,{w:()=>n});var a=s(95155),r=s(12115),l=s(47321),i=s(64269);let n=r.forwardRef((e,t)=>{let{className:s,orientation:r="horizontal",decorative:n=!0,...o}=e;return(0,a.jsx)(l.b,{ref:t,decorative:n,orientation:r,className:(0,i.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",s),...o})});n.displayName=l.b.displayName},86948:(e,t,s)=>{"use strict";s.d(t,{BT:()=>c,Wu:()=>d,ZB:()=>o,Zp:()=>i,aR:()=>n});var a=s(95155),r=s(12115),l=s(64269);let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});i.displayName="Card";let n=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",s),...r})});n.displayName="CardHeader";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",s),...r})});o.displayName="CardTitle";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",s),...r})});c.displayName="CardDescription";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",s),...r})});d.displayName="CardContent",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",s),...r})}).displayName="CardFooter"},90960:(e,t,s)=>{"use strict";s.d(t,{JR:()=>a,hD:()=>r,nr:()=>i,rP:()=>l});let a="https://powerful-spontaneity-production.up.railway.app";if(!a)throw Error("NEXT_PUBLIC_API_BASE_URL is not set.");class r extends Error{constructor(e,t,s){super(t),this.name="ApiError",this.status=e,this.body=s}}let l=async function(e){var t;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.startsWith("http://")||e.startsWith("https://")?e:new URL(e.startsWith("/")?e:"/".concat(e),a).toString(),l=new Headers(null!=(t=s.headers)?t:{});return s.body&&"string"==typeof s.body&&!l.has("Content-Type")&&l.set("Content-Type","application/json"),fetch(r,{...s,headers:l})},i=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=await l(e,t),a=await s.text();if(!s.ok){var i;throw new r(s.status,(i=s.status,401===i?"Unauthorized (401). Please sign in.":403===i?"Forbidden (403).":404===i?"Not Found (404).":i>=500?"Server error. Please try again later.":a||"Request failed (status ".concat(i,").")),a)}return a?JSON.parse(a):null}}},e=>{e.O(0,[4909,1171,4964,7526,8441,1255,7358],()=>e(e.s=82413)),_N_E=e.O()}]);